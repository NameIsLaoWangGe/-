{
  "code": "import { Admin, DataAdmin, Effects2D, EventAdmin, TimerAdmin, Tools } from \"../Frame/Lwg\";\r\nimport { _LwgEvent } from \"../Frame/LwgEvent\";\r\nimport _EnemyBullet from \"./_EnemyBullet\";\r\nimport { _Res } from \"../Frame/_PreLoad\";\r\nexport class _EnemyData extends DataAdmin._Table {\r\n    constructor(_EnemyParent) {\r\n        super();\r\n        this._otherPro = {\r\n            quantity: \"quantity\",\r\n            shellNum: \"shellNum\",\r\n            blood: 'blood',\r\n            boss: 'boss',\r\n            speed: 'speed',\r\n        };\r\n        this.EnemyParent = _EnemyParent;\r\n        this._arr = _Res._list.json.Enemy.dataArr;\r\n        this.levelData = this._getObjByName(`level${Admin._game.level}`);\r\n        this.quantity = this.levelData['quantity'];\r\n        this.presentQuantity = 0;\r\n        EventAdmin._register('presentQuantity', this, () => {\r\n            this.presentQuantity--;\r\n        });\r\n    }\r\n    get presentQuantity() {\r\n        return this['_presentQuantity'];\r\n    }\r\n    ;\r\n    set presentQuantity(val) {\r\n        this['_presentQuantity'] = val;\r\n        if (val < 10) {\r\n            if (this.quantity > 0) {\r\n                this.createEnmey();\r\n            }\r\n        }\r\n        if (val === 0 && this.quantity === 0) {\r\n            EventAdmin._notify(_LwgEvent.Game.creatBoss);\r\n        }\r\n    }\r\n    ;\r\n    createEnmey() {\r\n        this.presentQuantity++;\r\n        this.quantity--;\r\n        const shellNum = this.levelData[this._otherPro.shellNum];\r\n        let shellNumTime = 0;\r\n        const element = Tools._Node.createPrefab(_Res._list.prefab2D.Enemy.prefab, this.EnemyParent);\r\n        shellNumTime++;\r\n        const color = Tools._Array.randomGetOne(['blue', 'yellow', 'red']);\r\n        element.name = `${color}${color}`;\r\n        let speed = Tools._Number.randomOneBySection(this.levelData[this._otherPro.speed][0], this.levelData[this._otherPro.speed][1]);\r\n        speed = Tools._Number.randomOneHalf() == 0 ? -speed : speed;\r\n        element['_EnemyData'] = {\r\n            shell: shellNumTime <= shellNum ? true : false,\r\n            blood: this.levelData['blood'],\r\n            angle: Tools._Number.randomOneBySection(0, 360),\r\n            speed: speed,\r\n            color: color,\r\n        };\r\n        element.addComponent(_Enemy);\r\n    }\r\n}\r\nexport default class _Enemy extends Admin._ObjectBase {\r\n    lwgOnAwake() {\r\n        this.generalProInit();\r\n    }\r\n    generalProInit() {\r\n        this._Owner.pos(this._SceneImg('Land').width / 2, this._SceneImg('Land').height / 2);\r\n        const shell = this._Owner['_EnemyData']['shell'];\r\n        this.Shell = this._Owner.getChildByName('Shell');\r\n        this.Shell.removeSelf();\r\n        this.Pic = this._Owner.getChildByName('Pic');\r\n        if (this._Owner['_EnemyData']['color']) {\r\n            this.Pic.skin = `Game/UI/Game/Enemy/enemy_01_${this._Owner['_EnemyData']['color']}.png`;\r\n        }\r\n        this.blood = this._Owner['_EnemyData']['blood'];\r\n        this.bloodPresnt = this.blood;\r\n        this.bloodPic = this._Owner.getChildByName('Blood').getChildByName('Pic');\r\n        this.bloodWidth = this.bloodPic.width;\r\n        const angle = this._Owner['_EnemyData']['angle'];\r\n        this._Owner.rotation = angle;\r\n        this.speed = this._Owner['_EnemyData']['speed'];\r\n        this.groundRadius = 200;\r\n    }\r\n    lwgOnStart() {\r\n        this.attack();\r\n        this.appear(() => {\r\n            this.move();\r\n        });\r\n    }\r\n    appear(func) {\r\n        let radius = 0;\r\n        const radiusSpeed = 2;\r\n        const time = 220 / radiusSpeed;\r\n        TimerAdmin._frameNumLoop(1, time, this, () => {\r\n            radius += radiusSpeed;\r\n            let point = Tools._Point.getRoundPos(this._Owner.rotation, radius, new Laya.Point(this._SceneImg('Land').width / 2, this._SceneImg('Land').height / 2));\r\n            this._Owner.x = point.x;\r\n            this._Owner.y = point.y;\r\n        }, () => {\r\n            func();\r\n        });\r\n    }\r\n    attack() {\r\n        TimerAdmin._frameRandomLoop(100, 1000, this, () => {\r\n            let bullet = Tools._Node.createPrefab(_Res._list.prefab2D.EnemyBullet.prefab);\r\n            bullet.addComponent(_EnemyBullet);\r\n            this._SceneImg('EBparrent').addChild(bullet);\r\n            bullet.pos(this._gPoint.x, this._gPoint.y);\r\n        });\r\n    }\r\n    move() {\r\n        TimerAdmin._frameLoop(1, this, () => {\r\n            let point = Tools._Point.getRoundPos(this._Owner.rotation += this.speed, 220, new Laya.Point(this._SceneImg('Land').width / 2, this._SceneImg('Land').height / 2));\r\n            this._Owner.x = point.x;\r\n            this._Owner.y = point.y;\r\n        });\r\n    }\r\n    lwgEvent() {\r\n        this._evReg(_LwgEvent.Game.enemyBlood, (Enemy, num) => {\r\n            if (Enemy === this._Owner) {\r\n                this.bloodPresnt -= num;\r\n                this.bloodPic.width = this.bloodWidth * this.bloodPresnt / this.blood;\r\n                if (this.bloodPresnt <= 0) {\r\n                    for (let index = 0; index < 20; index++) {\r\n                        Effects2D._Particle._spray(Laya.stage, this._gPoint, [10, 30]);\r\n                    }\r\n                    this._evNotify('presentQuantity');\r\n                    if (this._Owner.name === 'Boss') {\r\n                        Admin._openScene('Victory');\r\n                    }\r\n                    this._Owner.destroy();\r\n                }\r\n            }\r\n        });\r\n    }\r\n    attack1() {\r\n        TimerAdmin._frameRandomLoop(100, 1000, this, () => {\r\n            let bullet = Tools._Node.createPrefab(_Res._list.prefab2D.EnemyBullet.prefab);\r\n            bullet.addComponent(_EnemyBullet);\r\n            this._SceneImg('EBparrent').addChild(bullet);\r\n            bullet.pos(this._gPoint.x, this._gPoint.y);\r\n        });\r\n    }\r\n    attack2() {\r\n        TimerAdmin._frameRandomLoop(100, 1000, this, () => {\r\n            let bullet = Tools._Node.createPrefab(_Res._list.prefab2D.EnemyBullet.prefab);\r\n            bullet.addComponent(_EnemyBullet);\r\n            this._SceneImg('EBparrent').addChild(bullet);\r\n            bullet.pos(this._gPoint.x, this._gPoint.y);\r\n        });\r\n    }\r\n    attack3() {\r\n        TimerAdmin._frameRandomLoop(100, 1000, this, () => {\r\n            let bullet = Tools._Node.createPrefab(_Res._list.prefab2D.EnemyBullet.prefab);\r\n            bullet.addComponent(_EnemyBullet);\r\n            this._SceneImg('EBparrent').addChild(bullet);\r\n            bullet.pos(this._gPoint.x, this._gPoint.y);\r\n        });\r\n    }\r\n}\r\n",
  "references": [
    "F:/Work/Game/07_RescueFlowerGirl_2.5.0/Project/RescueFlowerGirl_2.5.0/src/script/Frame/Lwg.ts",
    "F:/Work/Game/07_RescueFlowerGirl_2.5.0/Project/RescueFlowerGirl_2.5.0/src/script/Frame/LwgEvent.ts",
    "F:/Work/Game/07_RescueFlowerGirl_2.5.0/Project/RescueFlowerGirl_2.5.0/src/script/Game/_EnemyBullet.ts",
    "F:/Work/Game/07_RescueFlowerGirl_2.5.0/Project/RescueFlowerGirl_2.5.0/src/script/Frame/_PreLoad.ts",
    "F:/Work/Game/07_RescueFlowerGirl_2.5.0/Project/RescueFlowerGirl_2.5.0/src/script/Game/_BossBullet.ts"
  ]
}
